# 楓之谷腳本工具 (Maple Macro GUI)

一個專為楓之谷設計的宏工具，具備按鍵錄製、播放、小地圖追蹤、智慧位置校正等功能。

## 主要功能

### 按鍵錄製與播放
- 即時錄製：支援全域按鍵監聽，精確記錄按鍵時序
- 智能播放：高精度時間控制，重現操作序列
- 技能設定：可自定義技能鍵並設定重複間隔
- 迴圈播放：支援無限迴圈或指定次數播放
- 安全機制：遊戲視窗失去焦點時自動停止播放

### 小地圖追蹤功能
- 實時位置檢測：透過小地圖自動追蹤角色位置
- 模板匹配：使用圖像識別技術進行位置判斷
- 視覺化顯示：即時顯示當前位置

**注意事項：**
追蹤功能可能因遊戲解析度、介面設定、顯示比例或遊戲版本更新而產生誤差，使用前請先測試並調整相關參數。

### 智能位置校正
- 偏差檢測：自動識別角色位置偏差
- 智能修正：根據偏差自動進行移動或跳躍
- 容錯機制：設定合理的偏差容忍範圍

**注意事項：**
位置校正功能依賴小地圖追蹤結果，可能因環境變化（地形、光線、介面元素）而影響準確性，建議在固定的小地圖環境下使用較為穩定。

### 自動回程系統
- 一鍵回城：支援 @回程 指令快速回程(僅支援有此指令的私服)
- 智能貼上：自動複製貼上回程指令
- 安全機制：播放過程中可隨時觸發回程

### 檔案管理
- JSON格式：使用標準 JSON 格式儲存腳本
- 匯入匯出：支援腳本的匯入和匯出

## 安裝與設定

### 系統需求
- 作業系統：Windows 10/11
- Python版本：3.7 或以上
- 記憶體：至少 2GB RAM

### 安裝步驟

1. 安裝相依套件
   ```
   pip install -r requirements.txt
   ```

2. 執行程式
   ```
   python maple_macro_gui_new.py
   ```

### 相依套件
```txt
tkinter          # GUI 界面框架
keyboard         # 全域按鍵監聽
pydirectinput    # 按鍵模擬
pyautogui        # 螢幕截圖
opencv-python    # 圖像處理
numpy            # 數值計算
Pillow           # 圖像處理
pywin32          # Windows API
pyperclip        # 剪貼簿操作
```

## 使用指南

### 第一次使用

1. 以管理員身分執行程式
2. 開啟楓之谷遊戲
3. 點擊「重新檢測視窗」設定小地圖監控區域
4. 開始錄製或播放腳本

### 基本操作

**錄製腳本：**
1. 點擊「開始錄製」
2. 在遊戲中執行想要記錄的操作
3. 按 ESC 鍵或點擊「停止錄製」

**播放腳本：**
1. 載入已錄製的腳本檔案
2. 設定播放次數或選擇無限迴圈
3. 點擊「開始播放」
4. 注意：遊戲視窗失去焦點時會自動停止播放

**停止播放：**
- 點擊「停止播放」按鈕
- 將遊戲視窗切換到背景（自動停止）

## 安全機制與注意事項

### 使用限制
- 本工具僅供學習和研究使用
- 使用前請詳閱遊戲服務條款
- 建議在私人伺服器或測試環境使用
- 使用者需自負使用責任

### 功能限制
- 小地圖追蹤功能可能因遊戲環境變化而產生誤差
- 位置校正功能依賴追蹤結果，準確性會受環境影響
- 建議在相同的遊戲設定和環境下使用以確保穩定性
- 播放功能僅在遊戲視窗為前景時運作，切換到其他視窗會自動停止

## 常見問題

**程式無法啟動？**
- 確認以管理員身分執行
- 檢查是否安裝所有相依套件

**小地圖追蹤不準確？**
- 重新設定小地圖區域
- 確認遊戲解析度和介面設定
- 注意：追蹤功能可能因環境變化而有誤差

**位置校正異常？**
- 檢查小地圖設定是否正確
- 注意：校正功能準確性會受環境影響
- 建議在固定環境下使用

**按鍵播放沒有反應？**
- 確認楓之谷視窗在前景
- 檢查是否以管理員身分執行

