# 楓之谷自動化腳本

作者：**SchwarzeKatze_R**  
版本：**1.0.1**

---

## 📖 專案簡介
此專案為楓之谷自動化腳本，提供錄製、播放按鍵動作及小地圖輔助功能。  
採用 Python + Tkinter GUI，支援自動回城、位置校正與技能連發。

---

## ⚡ 功能特色
- **錄製與播放**：支援鍵盤動作錄製、迴圈播放  
- **小地圖偵測**：定位角色、偏移校正、回到起始點  
- **技能連發**：多按鍵技能自動重複施放  
- **回程功能**：支援傳統回城或自動回到錄製位置  
- **GUI 操作**：直覺化控制面板與狀態顯示  

---

## 🛠️ 環境需求
- Python 3.x

安裝套件：
```bash
pip install keyboard pydirectinput pyautogui pyperclip opencv-python numpy pillow pywin32
```

---

## ▶️ 操作說明
1. **以系統管理員模式啟動程式**  
   - 鍵盤與視窗控制需管理員權限，否則無法正常運作。  

2. **鎖定遊戲視窗**  
   - 啟動程式後會自動尋找遊戲視窗，預設關鍵字為 **「楓之谷」**。  
   - 若視窗標題不同，請修改 `find_maple_window` 方法中的關鍵字比對。  

3. **錄製**  
   - 點擊「開始錄製」後進行角色操作。  
   - 完成後點擊「停止錄製」，即可保存成檔案或直接使用。  

4. **播放**  
   - 載入錄製檔案或直接使用暫存動作。  
   - 可設定迴圈次數，並可選擇是否在結束時自動回程。  

5. **小地圖功能**  
   - 在 GUI 中設定小地圖區域，並標定角色位置。  
   - 可於播放過程中檢查角色偏移並進行修正。  

6. **回程**  
   - 程式內建「自動回城」功能，預設輸入指令為 **`@FM`**。  
   - 如需修改，請更改程式中的 `return_to_town` 方法內的指令字串（`pyperclip.copy('@FM')`）。  
   - 亦可選擇自動回到錄製時的起始點。  


---

## 📌 修改說明
- **視窗鎖定**：修改 `find_maple_window` 方法的關鍵字 `"楓之谷"` → 你的遊戲視窗標題。  
- **回程指令**：修改 `return_to_town` 方法內 `pyperclip.copy('@FM')` → 你常用的回城指令，例如 `@回城`。  

---
2025/10/01
- 修正錄製問題
- 修正連發時長、觸發問題
- 新增部分自訂義功能

---

## 重要聲明

- 可能違反遊戲服務條款（ToS），存在被停權等風險。
- 本工具僅供技術研究與個人學習之用，使用者需自負風險。
- 需以 Windows 系統管理員權限執行，方能正常使用鍵盤注入與前景視窗控制。

---

## 📄 授權
本專案採用 MIT 授權條款 [MIT License](https://github.com/kuroneko11375/Salary-Calculator/blob/main/LICENSE).
